#!/usr/bin/env bash

if [[ $1 == "list" ]]; then
  AWS_CONFIG_FILE=~/code/root-infrastructure/.aws-config aws-okta list
  return
fi

AWS_CONFIG_FILE=~/code/root-infrastructure/.aws-config aws-okta env --assume-role-ttl=12h --session-ttl=12h $1

if [[ $? -eq 0 ]]; then
  eval $(AWS_CONFIG_FILE=~/code/root-infrastructure/.aws-config aws-okta env --assume-role-ttl=12h --session-ttl=12h $1)
  export ROOT_AWS_DEFAULT_ROLE_SESSION_DURATION=3600
  echo ""
  echo "Successfully exported the above variables and logged in as $1"
fi
